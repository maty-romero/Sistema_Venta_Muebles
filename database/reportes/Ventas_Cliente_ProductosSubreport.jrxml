<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.21.2.final using JasperReports Library version 6.21.2-8434a0bd7c3bbc37cbf916f2968d35e4b165821a  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Ventas_Cliente_TotalSubreport" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="3e5a8168-24cd-4cef-9285-c6f2a79c6260">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="MysqlAdapter"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="220"/>
	<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="769"/>
	<parameter name="ID_Venta" class="java.lang.Integer"/>
	<queryString>
		<![CDATA[SELECT 
	pv.id_item AS id_producto_combo,
    pv.nombre_item AS nombre_producto_combo, 
    pv.unidades AS cantidad_producto,
    FORMAT(pv.precio_unitario,2,'en_US') AS precio_unitario,
    FORMAT(pv.total,2,'en_US') AS importe_producto_combo
FROM 
    ventas v
LEFT JOIN 
    (
        SELECT 
            pv.id_venta,
			p.id AS id_item,
            p.nombre_producto AS nombre_item,
            pv.unidades_vendidas_prod AS unidades,
            pv.precio_venta_prod AS precio_unitario,
            pv.unidades_vendidas_prod * pv.precio_venta_prod AS total
        FROM 
            producto_venta pv
        LEFT JOIN 
            productos p ON p.id = pv.id_producto
        UNION 
        SELECT 
            ocv.id_venta,
			oc.id_oferta_combo AS id_item,
            oc.nombre_combo AS nombre_item,
            ocv.unidades_vendidas_combo AS unidades,
            ocv.precio_combo AS precio_unitario,
            ocv.unidades_vendidas_combo * ocv.precio_combo AS total
        FROM 
            oferta_combo_venta ocv
        LEFT JOIN 
            oferta_combo oc ON oc.id_oferta_combo = ocv.id_oferta_combo
    ) AS pv ON v.id = pv.id_venta
WHERE 
    v.id = $P{ID_Venta};]]>
	</queryString>
	<field name="id_producto_combo" class="java.lang.Integer"/>
	<field name="nombre_producto_combo" class="java.lang.String"/>
	<field name="cantidad_producto" class="java.lang.Integer"/>
	<field name="precio_unitario" class="java.lang.String"/>
	<field name="importe_producto_combo" class="java.lang.String"/>
	<background>
		<band height="65" splitType="Stretch"/>
	</background>
	<detail>
		<band height="16" splitType="Stretch">
			<rectangle>
				<reportElement x="-20" y="-20" width="555" height="17" uuid="5c03f654-afaf-4fa5-bcea-a3cc914294fc"/>
				<graphicElement>
					<pen lineWidth="0.25"/>
				</graphicElement>
			</rectangle>
			<textField>
				<reportElement x="-20" y="-20" width="91" height="17" uuid="0b24c8af-f228-4e1d-aa03-dfce88b93583"/>
				<box>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{id_producto_combo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="71" y="-20" width="189" height="17" uuid="bba58632-aa22-4812-aaea-37329e87fca3"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombre_producto_combo}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="264" y="-20" width="80" height="17" uuid="6ed7ec32-0e8e-433d-8690-ce5eb5c62842"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["$"+$F{precio_unitario}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="361" y="-20" width="69" height="17" uuid="b54b789f-b512-4471-b2e2-949b36703de9"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cantidad_producto}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="430" y="-20" width="80" height="17" uuid="39cb70b6-3ac4-471a-96eb-dfc2a7a3a413"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA["$"+$F{importe_producto_combo}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
